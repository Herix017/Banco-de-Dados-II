from pymongo import MongoClient

# ğŸ”Œ Conectar ao MongoDB
cliente_mongo = MongoClient("mongodb://localhost:27017/")
db = cliente_mongo["empresa"]
clientes = db["clientes"]

# ğŸš¿ Limpar coleÃ§Ã£o para evitar duplicatas se reexecutar
clientes.delete_many({})

# ğŸ“¥ InserÃ§Ã£o de documentos
clientes.insert_many([
    {"nome": "Carlos Oliveira", "email": "carlos@email.com", "cidade": "Fortaleza", "compras": ["Notebook", "Mouse"]},
    {"nome": "Juliana", "email": "juliana@email.com", "cidade": "Sobral"},
    {"nome": "Rodrigo", "email": "rodrigo@email.com", "cidade": "Juazeiro"}
])

# ğŸ” Consulta: exibir todos os clientes
print("\nğŸ“„ Clientes cadastrados:")
for c in clientes.find():
    print(f"{c['nome']} ({c.get('email')}) - {c.get('cidade')}")

# ğŸ“ AtualizaÃ§Ã£o: mudar nome de Carlos
clientes.update_one(
    {"nome": "Carlos Oliveira"},
    {"$set": {"nome": "Carlos Silva"}}
)

# âŒ ExclusÃ£o: remover cliente Rodrigo
clientes.delete_one({"nome": "Rodrigo"})

# ğŸ§¾ Consulta final apÃ³s alteraÃ§Ãµes
print("\nğŸ§¾ Clientes apÃ³s atualizaÃ§Ã£o e exclusÃ£o:")
for c in clientes.find():
    print(f"{c['nome']} - {c.get('cidade')}")
